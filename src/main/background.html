<!-- Copyright (c) 2010 Kenneth Liu. All rights reserved. -->
<html>
<head>
	<script src="readitlater-client.js"></script> 
	<script>

		//TODO this is currently never invoked because of the popup
		//the Extensions API will provide a workaround for this	
	function addTab() {
		chrome.tabs.getSelected(null, 
			function(tab) { 
				console.debug(tab)
				add(localStorage.username, localStorage.password, tab.url, encodeURI(tab.title));
				chrome.tabs.remove(tab.id, function(){
					console.debug("closed tab" + tab.url);
				}); 
		});
	}

	function init(){
		chrome.browserAction.onClicked.addListener(addTab);
	}

	</script>               
</head>

<body onload="init()">
</body>
</html>